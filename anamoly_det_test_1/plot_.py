import matplotlib
import numpy as np
import torch
import tqdm
from matplotlib import pyplot as plt
from sklearn.metrics import roc_auc_score
from sklearn.svm import OneClassSVM
from torch.utils.data import ConcatDataset, DataLoader
from torchvision.datasets import CIFAR10, MNIST
from torchvision.transforms import Compose, Normalize

from anamoly_det_test_1.datasets import OneClassDataset

if __name__ == '__main__':
    matplotlib.rcParams.update({'font.size': 18})

    mnist_ent_max_gaussian_p_x = torch.tensor( [[0.9693357700307883, 0.9472230155513717, 0.9525257030558393, 0.956412252207728, 0.9646830131643762, 0.9636079272826776, 0.9660320698322279, 0.9684029254600869, 0.9674514264237797, 0.9695048569533207, 0.970356736129956, 0.9712091166403007, 0.969343896488497, 0.9710792550375142, 0.9692713648211871, 0.9697415026362067, 0.9705639486724846, 0.9716654596922846, 0.9721170481600568, 0.972086677040501, 0.9729105138735211, 0.9735102545384446, 0.9729406747563599, 0.9743615030049296, 0.9747964180838508, 0.9748761139715881, 0.9750652138123582, 0.9753017786349686, 0.9758939831221964, 0.9762652773361907, 0.9759210713145584, 0.9759201818515256, 0.976161436570127, 0.9766904083217515, 0.9768276767257926, 0.9767341860750196, 0.9760120714688398, 0.9763648001635318, 0.975578433982275, 0.9754725231931529, 0.9759875708053004, 0.9764574336953825, 0.9760672181768725, 0.9755011800748637, 0.976038820048044, 0.9761986161248974, 0.9757549034479792, 0.977241584305085, 0.9774147546715407, 0.9775449720595403], [0.9928902665104987, 0.9921674075468159, 0.992617105144753, 0.9920580891071508, 0.9915996551108178, 0.9903985421560652, 0.990005191491287, 0.9901230619573036, 0.9897564026915199, 0.989832023594516, 0.9900447463859711, 0.9901097304402713, 0.9900281529020053, 0.9901013911508936, 0.9900696791593144, 0.9904480531411287, 0.9914787921447015, 0.991403227971565, 0.9913918819996227, 0.9914055255308833, 0.9912907042948262, 0.9912244721836125, 0.9912054960455389, 0.9913300464525366, 0.9911966745523536, 0.9912100060693857, 0.9909669895328446, 0.9908618549203333, 0.9908209810564107, 0.9908406946826606, 0.9908072098829656, 0.990777767085775, 0.9907846881286598, 0.99066059156054, 0.9906785323786738, 0.9903401671304214, 0.9901936339027853, 0.9901851527887584, 0.9901139993622147, 0.9901125669332568, 0.9901095177032974, 0.9900562909124224, 0.9899648849259615, 0.9899879456139344, 0.9899874917750567, 0.9900109070246529, 0.9899639488832763, 0.989913189841299, 0.9894830356800325, 0.9893139806980906], [0.7689555167815123, 0.8086200633835653, 0.8051597722276149, 0.8064023460038949, 0.8063751416349565, 0.803164518613386, 0.8064458668428415, 0.8113351485982907, 0.8171708471277477, 0.820463237040017, 0.8264914729912443, 0.8315409667962141, 0.8311346543984035, 0.8273640581229262, 0.8278688229627635, 0.8300012979359743, 0.8237600097929576, 0.8244884379125254, 0.8261911638241253, 0.8206978035970667, 0.8254218599484024, 0.8272339262009599, 0.8226683902764296, 0.8207675138313225, 0.8207993163383689, 0.8211774401503883, 0.8231342631722047, 0.8236863165561268, 0.8260996009000664, 0.820279680597026, 0.8224760989088726, 0.8237695597721044, 0.8243536463388978, 0.8250251129081269, 0.8265960152750456, 0.8247022590237307, 0.8230673210478465, 0.8240142760654455, 0.8264777862256392, 0.8265675960134297, 0.8255043803801292, 0.8262590440301711, 0.82464595874409, 0.8240760356729399, 0.8230607698544221, 0.8227296885322742, 0.822606184695674, 0.824833206000278, 0.8252803018839141, 0.8227896181115586], [0.8513519413794097, 0.8642961088930923, 0.8549812805935775, 0.8556603739407971, 0.8602464828165631, 0.8629160596582733, 0.8673033422752383, 0.8726468432649594, 0.8719341055472417, 0.8706198171957702, 0.8647360058871347, 0.8656873414158578, 0.8676358797049943, 0.8705932450735648, 0.8688499752471309, 0.8690860528805708, 0.8695978694418862, 0.86977026533847, 0.8672453781912338, 0.8685937361931678, 0.8689069785134386, 0.8690444069463025, 0.8703410225525965, 0.8692996379292394, 0.8708937447460203, 0.8707685864276783, 0.8711956620183566, 0.8712052071908856, 0.8716789848220732, 0.8726442915851744, 0.8741335590152343, 0.8747907583198543, 0.8743089318715673, 0.8746544324646752, 0.8750874147215227, 0.8745443007050668, 0.8745957595807308, 0.8732830463402376, 0.8730328242102119, 0.8732888584997477, 0.8728056302026901, 0.8732052043556859, 0.8721124081099945, 0.8732764781274577, 0.8729401919335732, 0.872352360516441, 0.8714191387639695, 0.8708916183461998, 0.8707597343039797, 0.870004515843175], [0.9217943045736259, 0.9193177105590898, 0.9153753894012704, 0.9209065057833454, 0.9204635412865284, 0.9251001211628226, 0.9262714198100958, 0.9281439405564567, 0.9278786067410166, 0.9277020076715824, 0.9274854014014964, 0.9292856287171881, 0.9297282869542095, 0.9286157901876684, 0.9295398243474347, 0.929167638101246, 0.9272600909056443, 0.9269904049773212, 0.9266666400166914, 0.9258655772242779, 0.9254986779892954, 0.9260310219895824, 0.9265886243635277, 0.9269385987150757, 0.9265372855504436, 0.926842304187803, 0.9271415683647944, 0.9267881767986864, 0.9255316734525241, 0.9280678108188755, 0.9289268856641274, 0.9274406391145468, 0.9264841736543331, 0.9271576873013986, 0.9278629391346375, 0.9276894510199676, 0.9279231917196635, 0.9281566261595642, 0.9300692669391326, 0.9302921112376843, 0.9307388636846032, 0.9304267365962015, 0.9288771103878938, 0.9288434379293278, 0.9290064970920151, 0.9290935715875501, 0.9291118021048494, 0.9285702380728251, 0.9287519307262265, 0.9289700682952895], [0.7859305575241472, 0.7465596881779097, 0.770664860326931, 0.7519646954722018, 0.7428999385376956, 0.7577974533665592, 0.7502123438472671, 0.7517605369759236, 0.7572200604680922, 0.7610958857715084, 0.76344786276437, 0.7617921862956312, 0.7563006079128157, 0.7567300483917951, 0.7533141165936181, 0.754191040529563, 0.7568253329184681, 0.7555779734422854, 0.7593939840733137, 0.7622897852241354, 0.7616874842145946, 0.7622613741348965, 0.763584390898284, 0.7640759168244415, 0.762477185754518, 0.7652820150904779, 0.7672324346064388, 0.7697512167304209, 0.7706301826033866, 0.7691425082633319, 0.7674129347979233, 0.7595078396651336, 0.76119609911168, 0.7627467214412752, 0.7602062701408042, 0.7615608841192995, 0.7624972354637143, 0.7632276504184105, 0.7653244556952827, 0.7665536841789522, 0.7684287984658151, 0.7694291715769972, 0.7703619143258148, 0.7690955789176622, 0.7680761066541728, 0.7674040629336256, 0.7691682437109573, 0.7700634922713738, 0.7719204579628186, 0.7717841762695795], [0.953677721709955, 0.9265188549587723, 0.921834351554332, 0.9306067594828432, 0.9331942537066917, 0.9342085445633137, 0.938192319613753, 0.9395199745366479, 0.9356858535653523, 0.9339187282770075, 0.931317558481507, 0.9335569622781761, 0.934049249784928, 0.9343579836697469, 0.9341409935231699, 0.9342950958837819, 0.9336031483381815, 0.9356781145477788, 0.9360548955636114, 0.9373999798124089, 0.9385560534397023, 0.9387465854065411, 0.9395229841545931, 0.9394813290578679, 0.938159478398153, 0.9386408353694004, 0.9402455901159648, 0.9393853685472303, 0.9396149924746322, 0.9400002070352564, 0.9402879232035458, 0.9406259925951493, 0.940650019929624, 0.9412158942487722, 0.9412472968008488, 0.9403987333675614, 0.9403565656436038, 0.9403879185865937, 0.9396365062820319, 0.9399591637839377, 0.9393582819857235, 0.9394227572624727, 0.93912602877671, 0.9394671904680705, 0.9390944939337348, 0.9387691244684055, 0.9388205525552715, 0.9396807906603684, 0.9402856742582681, 0.9404234717656165], [0.9327310127844906, 0.9328484913995974, 0.9257633814084019, 0.928268097461984, 0.9267674489328697, 0.923250303942758, 0.9201722028935885, 0.9149700549755861, 0.9181305446322867, 0.9182783663308679, 0.9190442344449348, 0.9182266776017597, 0.9153457600566999, 0.9154928681653833, 0.9163646113023083, 0.9170758587635572, 0.917875668936234, 0.9198295866657724, 0.9199043895024349, 0.9197541478033314, 0.919074453425818, 0.9203298442096739, 0.9198431758994753, 0.9202356968816554, 0.9198990375782025, 0.9203662683201022, 0.9193927765714661, 0.9169979843877699, 0.9170917749208395, 0.9179452439512552, 0.9182604955577787, 0.9183692559658753, 0.9187559441262833, 0.9198966020648561, 0.920476548984937, 0.9204404506438102, 0.9204224712809541, 0.920880906251724, 0.9213254417323135, 0.9216749301411004, 0.9218672736441653, 0.9221456822940165, 0.9224518433857568, 0.9225060607051546, 0.9226850631796982, 0.9230336518447012, 0.9230904753185075, 0.9232292840664249, 0.9235606534969412, 0.9238950013896386], [0.7670950287206182, 0.81471506497791, 0.8076400663389804, 0.8235572612499583, 0.8249854670178093, 0.8146774913074322, 0.8255435790383773, 0.8284820448397553, 0.8312407843341196, 0.83388358500271, 0.8343077676900563, 0.8346988783966833, 0.8373929690756665, 0.8375531772260002, 0.8356479548595903, 0.8386207277623433, 0.8394561081185619, 0.8377557207619719, 0.8377180008272057, 0.837217386923485, 0.8344370815724061, 0.8345162755586686, 0.8305736079093227, 0.8321015496701333, 0.8320585154662297, 0.831722010093861, 0.8333418870855948, 0.8346935153727829, 0.834923475336997, 0.8356178244162227, 0.8352540163767248, 0.8335864084722777, 0.8344011005575107, 0.8352558690577085, 0.8391020835347852, 0.839160638004825, 0.8395903462319476, 0.8404839397748667, 0.8394496562382937, 0.8408856790197693, 0.8400097184493711, 0.8398623490532232, 0.8394009502303256, 0.838554161259628, 0.8420610750912729, 0.842422802927561, 0.8428365358440952, 0.8429280485337411, 0.843208453425794, 0.8435863840948963], [0.9005541997282225, 0.9080919483287512, 0.9120542728778136, 0.9093566989446117, 0.9095784429773862, 0.9101382503693088, 0.9142561180208365, 0.9165343198293809, 0.9161741685321935, 0.9158729393643811, 0.9167617076840462, 0.9161938354435726, 0.9172302706685799, 0.9155579386423179, 0.9163898442773643, 0.9172125531552909, 0.9150868917473144, 0.9155790990441692, 0.9166663758290483, 0.9160980162390522, 0.9168899592132469, 0.917992721136182, 0.9176638859760584, 0.9170712532356472, 0.917694683321695, 0.9177428837615738, 0.9182093244175412, 0.9191275538018938, 0.9202139344924893, 0.9207251641416774, 0.9211831783671897, 0.9216867047497304, 0.9219262291796031, 0.9216575423831374, 0.9218320606750784, 0.9221734883180274, 0.9218142802779803, 0.9218043917989577, 0.9218893321044581, 0.9217242463839216, 0.9220865671725323, 0.921668625654538, 0.9216918926640031, 0.922090796108712, 0.921461140525537, 0.9215581702433877, 0.9214302331332338, 0.9218214647532005, 0.9214064944951985, 0.9212071999823673]]).mean(dim=0)
    mnist_ent_max_gaussian_cossim = torch.tensor( [[0.9636337783128213, 0.9776020998443278, 0.9847087477557231, 0.9859922914281962, 0.9900203056324357, 0.9909594168745046, 0.9909376412022565, 0.9912067846299494, 0.9915945015659402, 0.9916230452432648, 0.9911291102491047, 0.9918349961979499, 0.9917134955476715, 0.9923414807069, 0.9924329902809184, 0.992453472188755, 0.9928698460064564, 0.9928011309441602, 0.9934061356130325, 0.9935366845281626, 0.9939456272865264, 0.9941732974788089, 0.9941279752942749, 0.9942581684241918, 0.9945593244350373, 0.9945376619671753, 0.9946810353220324, 0.9946195168242741, 0.9946387858279753, 0.9946319773927607, 0.9945829275495164, 0.9947092474722269, 0.9947279666260533, 0.9947070885028655, 0.9951070638566535, 0.995148367285485, 0.9949262602801711, 0.9949206647490921, 0.9949748168757335, 0.9949873340464133, 0.9950799675782638, 0.9950535586122178, 0.995058790272056, 0.994971081130996, 0.9950136055499906, 0.9951733369386235, 0.9951634962430699, 0.9952787140499257, 0.9952477122202193, 0.9953778972641087], [0.9965907623507464, 0.9980270560301678, 0.9980148449278647, 0.9982486215885056, 0.9981000531771522, 0.9980298499757586, 0.9980550947633305, 0.9980029032923954, 0.9979947696487592, 0.9981058396228429, 0.998061994532518, 0.9979914580431986, 0.9979870614790708, 0.9979521797065803, 0.9979228787340392, 0.9979609515611384, 0.9980936001556101, 0.99814583417394, 0.9981592366032968, 0.9981721355551488, 0.9981689374093075, 0.998205393435405, 0.9981821483753881, 0.9981465220234889, 0.9981454867035491, 0.998131637526547, 0.9980878420748494, 0.9980787936622252, 0.9981005637458895, 0.998102662750699, 0.9981095908848162, 0.9981118671704373, 0.9981239151743936, 0.9981238158971392, 0.9981191569574103, 0.9981141576385231, 0.9981250852277502, 0.9981157318921302, 0.9980943447350188, 0.9981014643324126, 0.9981037973478932, 0.998151627710863, 0.9981475857083585, 0.9981363319224381, 0.998131637526547, 0.9981363035575083, 0.9981331905064564, 0.9982173492533393, 0.9982058330918178, 0.998183034779446], [0.926176262165843, 0.946473089665846, 0.9586003713573212, 0.9594545254906015, 0.9586654834534694, 0.9589287768399011, 0.959947318255131, 0.9635497057191611, 0.9631164657634016, 0.9641741759336835, 0.9635402249427616, 0.9645306854209187, 0.9661063858449933, 0.9658949022488125, 0.9647817376102478, 0.9662455295025154, 0.9641088024049338, 0.9639481136253751, 0.9652244198964357, 0.9650992705722852, 0.9663549159786375, 0.9662347338739143, 0.9656633498558738, 0.9652554842408427, 0.963311025443236, 0.964010865138916, 0.9667207601475833, 0.9668246180931044, 0.9667175998887836, 0.9672735670725331, 0.967402145777279, 0.9677127969105432, 0.9671722696286673, 0.9674388232334231, 0.9670563780942856, 0.9666275671143623, 0.9665124675669791, 0.9666950782390885, 0.967767182580838, 0.9675964901596769, 0.967338955979671, 0.9671619122841335, 0.967548148195992, 0.9678012226433851, 0.9676808713763903, 0.9674034221835097, 0.967618635038858, 0.9677551797487541, 0.967796616816083, 0.9674249365487697], [0.8858746095102995, 0.9159717985829987, 0.9354982446175701, 0.9343399631329524, 0.9436157995601975, 0.9462093536705362, 0.948879481801089, 0.9489566701145845, 0.9489801471437174, 0.9476234961824823, 0.9488665422644016, 0.950078684668925, 0.9512976315528752, 0.949669360578973, 0.950167135025916, 0.9488671329310185, 0.9460230259173485, 0.9468777598897674, 0.9475892611453671, 0.947762822624075, 0.9479309499699075, 0.9480440823159297, 0.9476158962720115, 0.9463223521321253, 0.9478523440565314, 0.9474608265961899, 0.950093553716561, 0.9494744327198432, 0.9495789807110334, 0.9488425139464265, 0.9500678715320584, 0.9504296508971282, 0.9503559593300045, 0.9505953289453892, 0.9516310746714436, 0.9507467758659606, 0.9509727964158035, 0.950423523715422, 0.9497099196866663, 0.9483078897781442, 0.947976683317165, 0.9487216950588295, 0.9482176595457474, 0.9485491889044774, 0.9485346585057016, 0.9472848866999046, 0.9467061042953433, 0.9468159997883051, 0.9470466984177537, 0.9468909671953213], [0.9448610589573962, 0.963198976731219, 0.9670598972591877, 0.9698436134323096, 0.9708617983007803, 0.9718014275317111, 0.9725732263947201, 0.974855756472011, 0.9753570715193349, 0.9746836384669524, 0.9736826444443698, 0.9745813315763263, 0.9746589442560749, 0.9741944126220816, 0.974924624628652, 0.9758120849212636, 0.9754216842767125, 0.9767777704132148, 0.9776966706916727, 0.9780037364339806, 0.9779017358031499, 0.977922577588179, 0.9779528328321849, 0.9779888022392169, 0.9778940148325165, 0.9780644887060415, 0.9779223519230665, 0.9787235114290997, 0.978722528173967, 0.978902052830395, 0.9787167817730676, 0.9780071939458821, 0.9780956627294337, 0.978298084335308, 0.9782095107786686, 0.9779147034876479, 0.978029978062772, 0.9780247313489074, 0.9781832691498769, 0.978178522123047, 0.9778341974587786, 0.9782222689169906, 0.9780835977053856, 0.9781216706336445, 0.9781758383201025, 0.9784570170502243, 0.9784428807428225, 0.9784130042938268, 0.9782895412989077, 0.9777531917428748], [0.8181275300215791, 0.8317681622024643, 0.8440019261803153, 0.8445572450354701, 0.8567034697650033, 0.8552336887782394, 0.8615085700448826, 0.8775295286976997, 0.8824865244478655, 0.8875287710686534, 0.903154007607694, 0.9019991866049495, 0.901305456105008, 0.8985660127609798, 0.8976812995394166, 0.9019903147406518, 0.9039508383242851, 0.902157665561838, 0.9019001438579837, 0.9049216649588327, 0.9035373724819131, 0.9012296227887495, 0.903385873076997, 0.9024422429312189, 0.9022358928732244, 0.9025952297816373, 0.903652970761363, 0.9049298239054636, 0.9038271339069204, 0.9040161715075008, 0.9034579921802262, 0.9024399897593337, 0.9029842627913801, 0.9086653012445043, 0.9077621225752261, 0.9075514069967043, 0.9082935630892705, 0.907325940183497, 0.9091809695553528, 0.9094289328816005, 0.9106700785321937, 0.9108664389414007, 0.9123816354239741, 0.9119717693757468, 0.9117524899837708, 0.9121263580905523, 0.9124381319487027, 0.912576499586226, 0.9146648114612657, 0.9159637034428678], [0.9685035461898304, 0.9776041595698112, 0.9773113253973786, 0.9824257907589251, 0.9823052489456746, 0.9799245088601167, 0.9825542534897347, 0.9824636755650377, 0.9814849792283445, 0.9821166600014102, 0.9826779041391045, 0.9846014138060635, 0.9845608087683466, 0.9858692567063879, 0.9876876281816127, 0.987814362862558, 0.9887201917186161, 0.9891229430914982, 0.989314607799157, 0.9892508353178071, 0.989706941263767, 0.9897331348617078, 0.9899430970542917, 0.9900526835274944, 0.990324185792513, 0.9901495121971549, 0.9903356454916122, 0.9898870966632398, 0.9901625263143133, 0.990175929035987, 0.9899968981091529, 0.9902225367732319, 0.9903091046300625, 0.9900627293676137, 0.9899407075499342, 0.9898133362190388, 0.9897954852158968, 0.9897287775302321, 0.9896572081540406, 0.9897095043999291, 0.9895648443022111, 0.9894922827442794, 0.9894515371474828, 0.9896097735986789, 0.9895658778248572, 0.9894457576888462, 0.9893804886667048, 0.9901663875549189, 0.9902726584874733, 0.990622352941799], [0.9616958206404824, 0.968253704043492, 0.9693261288263079, 0.9704281055385806, 0.9680350352783333, 0.9676725781487976, 0.9690600761406626, 0.9689572649005173, 0.9675258345914751, 0.9699094885676383, 0.9693047366422022, 0.9688338836559307, 0.9691429223764977, 0.9710004046364977, 0.9707816815764554, 0.970896608332037, 0.9710097433564626, 0.9717986712832003, 0.9728977083153514, 0.9737047319511243, 0.9736145714188382, 0.9739144730861503, 0.9738793598093387, 0.9734652604891665, 0.9730263173815793, 0.9732954881448207, 0.9728563201012875, 0.9732953950678775, 0.9731554228581707, 0.9730435366160661, 0.9730721267504439, 0.972961388457305, 0.9728578636272618, 0.9731012055387731, 0.9731389094571696, 0.9733961741280971, 0.9732901672462362, 0.9734174499660238, 0.9736681837381053, 0.9737261784301134, 0.9736114068027704, 0.9737133570811914, 0.9740391651643531, 0.9741867619269882, 0.974496118660444, 0.9748369043750444, 0.9748432723892397, 0.9746759200454167, 0.9746531394635753, 0.9746253637524503], [0.8994447807620207, 0.9255950071872646, 0.9308900913257964, 0.9315110969902872, 0.9325710905384068, 0.9320978280565784, 0.9361335279190086, 0.9349523950370902, 0.9329581058449646, 0.9327780788835809, 0.9327168835305597, 0.9333822722807235, 0.933220097688293, 0.9329518977385103, 0.9337723916405084, 0.9333465269138479, 0.9324258419744379, 0.9318419630617666, 0.9303628654474185, 0.9304351606347545, 0.9309509047665094, 0.9291057726451653, 0.928652393980737, 0.9293874451610493, 0.9312813889256807, 0.9312336823903486, 0.9341654119086759, 0.9339660374322818, 0.9339454466708217, 0.9363445872868705, 0.9360990339243767, 0.9360302978347198, 0.9362274539694098, 0.9365127993440858, 0.9372341504360707, 0.9373754661158462, 0.9392957862071152, 0.9385136623033862, 0.9379893048302156, 0.937960628903936, 0.9373417440716241, 0.9366572109512947, 0.9364522052998052, 0.9364633782662644, 0.9367346010113362, 0.9370723252527731, 0.9368713581207964, 0.9367659503237723, 0.936662427710907, 0.9363917006392563], [0.9506129504992173, 0.9564683999896996, 0.9552323636932907, 0.9551056999802765, 0.954227048093443, 0.9548368166719065, 0.9555564982886643, 0.9553223504244924, 0.9556997869087793, 0.9566842879677271, 0.9557729286395475, 0.9560813501430558, 0.9563646967275801, 0.9581437661597634, 0.9599034280762815, 0.9603137527928665, 0.9604205216406927, 0.963241033421204, 0.9636690442091731, 0.9637368643975736, 0.9642765175285946, 0.9641478729755855, 0.965237932369029, 0.9652236498838269, 0.9655249655168772, 0.9651001618031857, 0.9651861789939213, 0.9657107400106946, 0.9657596950562856, 0.9658176503470919, 0.9660234769156208, 0.9663665080957088, 0.9669023331748348, 0.9668124722112517, 0.9670475004487546, 0.9667601528818597, 0.9664272224136511, 0.9663759328066373, 0.9665670995871081, 0.9666731609920789, 0.9667881204560749, 0.9666940384167881, 0.966126653525837, 0.9663848544470912, 0.9663725606623603, 0.9664521165416835, 0.9664416542479004, 0.9665361764738526, 0.9666977564220168, 0.9666190651950723]] ).mean(dim=0)
    mnist_ent_max_uniform_p_x = torch.tensor( [[0.9743215095125646, 0.9657322884460692, 0.9702788515123946, 0.9741226417504891, 0.969005221309723, 0.9658119519896965, 0.9671962960818667, 0.9673658115638604, 0.9685895671484754, 0.9706936647267748, 0.9715035289041524, 0.9711211891764963, 0.9703064572105211, 0.9716282963095693, 0.972154211542772, 0.9740855107118841, 0.9736135939707992, 0.9738914137060756, 0.9724000429529784, 0.9733754119426745, 0.9738247524947821, 0.9744992565706251, 0.9736320139416053, 0.9729557309396967, 0.9741240002031211, 0.9747598207230656, 0.9749551629771199, 0.9752614455294455, 0.9771569235964193, 0.9775160725970025, 0.9775109298834673, 0.9778485538786572, 0.9784600192835585, 0.9789948938353097, 0.9791100388679173, 0.9790785680486119, 0.9760209984432779, 0.975783447125304, 0.9758250254790728, 0.9761527683485712, 0.9760259147480409, 0.9757659004454753, 0.9758040179794439, 0.9759845789750993, 0.9762813038428362, 0.9763231409494874, 0.9755955601886696, 0.9759747787096834, 0.9761564555771435, 0.9763129848988582], [0.9882547774874074, 0.9873561765095692, 0.9876576389840789, 0.9881427643794062, 0.9870186763916775, 0.9875158426997287, 0.9877148368651335, 0.9878627316094026, 0.9884854269145317, 0.9884466095080238, 0.9885753862895701, 0.9888097089751106, 0.9888915985276049, 0.9892417068568177, 0.9892415083023085, 0.9893997562459753, 0.9895816321762121, 0.9896024094873315, 0.9895318517243148, 0.9896654930913313, 0.9895244201126926, 0.9895903260272129, 0.9896590826171838, 0.9896644861363213, 0.9896734920015506, 0.9895613370688999, 0.9895006219365434, 0.9897050479860156, 0.9895221509183041, 0.9894702430966676, 0.9894723704664066, 0.9894855459763247, 0.9894656479780306, 0.9894558904421604, 0.9894747814854444, 0.9895212999704083, 0.9895709669625862, 0.9895641735618856, 0.9895432686085819, 0.9894697183454652, 0.9894822556444616, 0.9894188458437684, 0.9891805237031182, 0.9891848493549213, 0.9891728226246622, 0.9891869767246604, 0.9891968051728556, 0.9889935137205774, 0.9890297215535387, 0.9888093402310225], [0.8423165419786942, 0.8354713906615044, 0.8298524658938105, 0.8322681338879395, 0.8413783987776027, 0.8481980681053457, 0.8451063661606562, 0.8441562585734514, 0.8467527302790624, 0.8518555101995624, 0.8535264336041158, 0.8580645344838829, 0.8624661214105304, 0.8615472011948393, 0.8644267736510385, 0.8653656550147695, 0.8621722557881178, 0.8496739166540563, 0.8512694090638989, 0.8511396154664759, 0.8508294179956669, 0.8503779700281364, 0.8519771686295642, 0.8488260599707933, 0.8481144865648249, 0.8491246621368086, 0.8491004257968158, 0.8499454374782395, 0.8491487908280831, 0.8492250676341518, 0.8483438706050104, 0.8480564023921391, 0.8483687835940893, 0.8479910288633895, 0.8480311818352936, 0.8474948297858468, 0.8459751066952582, 0.8463873859077369, 0.8472540196031393, 0.847922733440859, 0.8489259887380985, 0.8482688548267839, 0.8496484192862213, 0.8502915896209412, 0.8508884094932638, 0.8511590998844775, 0.8510805932121024, 0.8509679311392678, 0.85196054459179, 0.8500970222519127], [0.863484816481457, 0.8655454554189251, 0.8762191634617096, 0.8778132702784905, 0.8826820643215468, 0.8880565477442127, 0.8861695647921114, 0.8905734333276787, 0.8903968791381117, 0.8857398902683186, 0.884489724684777, 0.8861866704973367, 0.8866794597180331, 0.8817756509579273, 0.8835512105594181, 0.8852416039103075, 0.8868246849502398, 0.8864210627620296, 0.8857266278338806, 0.8887390275800358, 0.889947090447125, 0.8909049784375181, 0.8914613391373023, 0.8931678458735006, 0.8939075337400584, 0.893226250988579, 0.893154488932404, 0.893073827499201, 0.8907411826468764, 0.8911617372781042, 0.8906186862660876, 0.8903645736119453, 0.8903223921399442, 0.8900715557166369, 0.8900107406817616, 0.8898268622261454, 0.8894645709500077, 0.8904654279678909, 0.890515989030297, 0.8893584714745039, 0.8896558366761126, 0.8892388890490251, 0.8904065030661897, 0.8903591867323993, 0.8904409192410674, 0.8904002656267156, 0.8906824467584925, 0.8912304278678715, 0.8916267572922518, 0.8907806706791045], [0.9180683881991847, 0.9223577420026218, 0.9249007299170301, 0.9222552900415661, 0.9187416036459229, 0.920409575086778, 0.9208128225238026, 0.9169059146697025, 0.917378409058378, 0.9152370405683975, 0.9160495639247367, 0.9178347845104498, 0.9190113218121192, 0.9199833098082827, 0.9220331549762251, 0.9221552236831281, 0.921218229898332, 0.9210486103284471, 0.9217522019112159, 0.9225733972554481, 0.9233187852408311, 0.924620695631407, 0.9236151157713608, 0.9241773442801114, 0.9249604989339579, 0.9242376452219474, 0.9243697237884815, 0.9249914311733012, 0.9258146252656723, 0.9259718332543722, 0.9258964772257479, 0.9260795077508873, 0.9259530063364185, 0.9261762052515754, 0.9267322279697334, 0.9267160929141929, 0.926243759714883, 0.9261932913243758, 0.9267026336021285, 0.9270908259523648, 0.9272620735348467, 0.9274970715115978, 0.9276285053206675, 0.9276224284815677, 0.9278002848280573, 0.9279715968862856, 0.9281538375835316, 0.9283273901739478, 0.9286047164782213, 0.9285602765700036], [0.7727278592240738, 0.7980251793366395, 0.8030319032944261, 0.8037386071356123, 0.8058621864315256, 0.8062406664995094, 0.8100463618280013, 0.8156798196279577, 0.8105005871977168, 0.8113794650561559, 0.8162522485071153, 0.818311031508426, 0.8181298800094436, 0.8174010669191345, 0.8158341971078991, 0.8172740971628271, 0.8168941208478884, 0.8181953100086388, 0.8164383640254069, 0.8136954089017611, 0.8164115019918391, 0.8152966923929608, 0.8162451193304474, 0.817757402532185, 0.8171769291252814, 0.816871782760996, 0.8173193894382992, 0.8176490918555511, 0.817219457744613, 0.8167535616486488, 0.8170094902895684, 0.8172217813281194, 0.8178365451946497, 0.8176479476667032, 0.8146278700040929, 0.8127806387193084, 0.8100327371792584, 0.807948359553565, 0.808436470516084, 0.807104634697115, 0.8071544333163572, 0.8082656871283541, 0.808718574677263, 0.8081501944663365, 0.8063069590410669, 0.8057778157061711, 0.8056414812042162, 0.8061043143946491, 0.8057832197981144, 0.8065487525489888], [0.9199139920643982, 0.9343919493579855, 0.9420994486247632, 0.9172811964759293, 0.9182212390656611, 0.9252615126485313, 0.9279392127289245, 0.9298334364981858, 0.9313899381394528, 0.9337043012665927, 0.9348127336339952, 0.9314197035916583, 0.9325640694744174, 0.9328128259730426, 0.9335168615995106, 0.9334150637529683, 0.9326220128880439, 0.9335977244113353, 0.9332664845373769, 0.9339436981841354, 0.9334572645496507, 0.9335997418475404, 0.9312688092853395, 0.9315715570069926, 0.9338661426447782, 0.9342382438700696, 0.9344029129662146, 0.9348461866950016, 0.9355829312461711, 0.9357898342117229, 0.9350599026418358, 0.9351815606595443, 0.9341846991288246, 0.9345984554508413, 0.9344085684021337, 0.9346452202835287, 0.934655026346394, 0.93468295626238, 0.9334047450628707, 0.9336864419952695, 0.9340907891271168, 0.934322628927072, 0.9345093740669357, 0.9347970406261382, 0.9344643620886562, 0.9337531662172964, 0.933996779907235, 0.9327697983582435, 0.9332889409174296, 0.9335453372154539], [0.9216738907819017, 0.9071220863581531, 0.9110483200263295, 0.9164533756804468, 0.9198069844814054, 0.9232137247040914, 0.9241447268281693, 0.9243886349577515, 0.9252387997566844, 0.9250409026626769, 0.9238634017674318, 0.9253887622249585, 0.9262635458753602, 0.9262339629202557, 0.9273894200927928, 0.928165247439779, 0.9291562997050269, 0.9296998070018558, 0.9293697871870156, 0.9301002084985579, 0.9302972989257245, 0.9306592441320727, 0.9303042641836384, 0.9300501796416029, 0.9304463771630384, 0.9303389818834418, 0.9303416811147938, 0.9290659995573263, 0.929179537915172, 0.9293425156426662, 0.9297780847110635, 0.92892840080967, 0.9286256060007076, 0.9282025402683434, 0.9276677666913488, 0.9284974855884315, 0.928369846073695, 0.9289855655656016, 0.9292895703748252, 0.9295554291501721, 0.9293637837241812, 0.929495751316775, 0.9297805357372335, 0.9298895598633359, 0.9295487896615593, 0.9299229434602867, 0.9302378072462139, 0.9300974472159104, 0.9301391146608038, 0.9302445553245938], [0.8718222011312731, 0.872842540805705, 0.8689529508413854, 0.8664338572574308, 0.8644052690897243, 0.8548376994577659, 0.8519623710741242, 0.8539449184942254, 0.856173076157377, 0.8540674392129682, 0.8525131698802827, 0.8544027257162684, 0.8547165763755548, 0.8562406665101099, 0.8555722387130693, 0.8564371969586778, 0.8564390983944244, 0.8570641507042218, 0.8569833153076141, 0.8547404174545301, 0.8550798481126626, 0.8559607004109213, 0.856820701922319, 0.8546346846257544, 0.8539268954836025, 0.8537109606394674, 0.8538429560337675, 0.8536297514563453, 0.8542681463195436, 0.854303899812213, 0.854081236810821, 0.8548693575503656, 0.854494482179728, 0.8532979102896115, 0.8539273505280548, 0.8545842396979155, 0.8544915893971392, 0.8532626605961571, 0.8488447315197103, 0.8494171124341708, 0.8490547345343799, 0.8496145042168807, 0.8500978426830071, 0.8494446751267014, 0.8501380166074973, 0.8510004721086192, 0.8505736566640855, 0.8506706136355696, 0.8511111291684307, 0.8511187024082415], [0.9282387732198858, 0.9310838411279544, 0.9313178946664122, 0.9329854160812576, 0.9277383438649563, 0.9276391603766351, 0.9260723945453452, 0.918512282890111, 0.9185592256538022, 0.9193769038269798, 0.9197839507250015, 0.9184796933559075, 0.9187272826343311, 0.917857536666999, 0.9187338854343146, 0.9188448124740349, 0.9193968851574056, 0.9200839064956742, 0.9200989357261126, 0.9197858844021395, 0.9194699718648404, 0.9197677109812328, 0.9194680853505596, 0.919938487686517, 0.9210506035760954, 0.9194846080714703, 0.9206711312284803, 0.9212135984099703, 0.9211397728177754, 0.9212946241983375, 0.9215212102844332, 0.9216682640726341, 0.9218229425227205, 0.9215602296881444, 0.9214600715007777, 0.9219880754061139, 0.9218825563739987, 0.9227957550536023, 0.9226954239357599, 0.9230216022549379, 0.9229469906151259, 0.9231524162993702, 0.9231760134488345, 0.9231906496554643, 0.9230835113652583, 0.9230950819861815, 0.9229229218370913, 0.923239541817246, 0.9234384118643637, 0.9236712548894913]]).mean(dim=0)
    mnist_ent_max_uniform_cossim = torch.tensor( [[0.9784232763742771, 0.9884886664620363, 0.9878871226129642, 0.9907273317111684, 0.9894252386914478, 0.9937968928953897, 0.9944294466601956, 0.994807694857901, 0.9955142519470346, 0.9951757304027844, 0.9947117541407738, 0.9946122393994604, 0.9942966417433733, 0.9944200183520482, 0.9947382682251784, 0.9951607955098613, 0.9954969478480331, 0.9954908590692725, 0.9946213523525327, 0.994570313346506, 0.9942569312619735, 0.9937728854795321, 0.9936029414380774, 0.993504744719258, 0.9936413015528731, 0.9936035640622003, 0.9931082220992427, 0.9929040013869155, 0.9936226066571294, 0.9934867856520233, 0.9935330296437006, 0.9935428218230887, 0.9934914917200696, 0.9930576439967875, 0.9931870770401129, 0.9931516683253805, 0.9930206665927065, 0.9934662956581589, 0.9934891872022118, 0.9932789423993443, 0.9931051413227383, 0.9930753523971676, 0.9930924866895899, 0.9930919934419081, 0.9930713255554373, 0.9930635387108867, 0.9932091923255189, 0.994176669352306, 0.9944657205798781, 0.9947539470326382], [0.9945266322226596, 0.9915888906199376, 0.9915427196053643, 0.9955953589585419, 0.9964541426660949, 0.996150474818289, 0.9961634943210929, 0.9970902333093483, 0.9970884321363025, 0.9971201795840439, 0.9971042030373025, 0.9971036002825431, 0.9970830924382572, 0.9973415253141753, 0.9973156139507519, 0.9974393134098538, 0.9976323509399889, 0.9976167431373356, 0.997618643587636, 0.9976186648613333, 0.9975967742267171, 0.9975829817795745, 0.997571160695057, 0.9975582546519725, 0.9976146583149912, 0.9975734653456079, 0.9978681344194169, 0.9980073991337776, 0.9980204044541165, 0.9980148662015622, 0.9980497905214474, 0.9980855516067635, 0.9980666747459441, 0.9980487197453454, 0.9980844170095691, 0.9980760706289591, 0.9980646466534595, 0.9980450961255563, 0.99805077620276, 0.9980386927426412, 0.9980177877893374, 0.9981925015747855, 0.9981837509939249, 0.998184793405097, 0.9981574425214834, 0.998150542752296, 0.9981506774857126, 0.9981494507024965, 0.9981528261291494, 0.9981526913957326], [0.9381387874940486, 0.9431306200320116, 0.9387305555658078, 0.9605252227098195, 0.9570706215575477, 0.9619537904036396, 0.958616687827329, 0.9612370806159721, 0.9669274918217732, 0.9649164446027394, 0.9624637608279232, 0.9594473514724499, 0.9585525983940042, 0.9585964114223287, 0.9589524826254969, 0.9574973718334361, 0.952285505315386, 0.9525452078481451, 0.9530316032031336, 0.9525237011720792, 0.9535957209326932, 0.9535274947129101, 0.959567049157941, 0.9584318088429423, 0.9578863604768039, 0.9568278506303294, 0.9560997839028873, 0.9554151149872852, 0.9543165675068188, 0.9578079768315353, 0.9578343507675047, 0.9576575838829569, 0.9578981787682279, 0.9569634418801494, 0.9571846292393603, 0.9559079769545623, 0.9567723269592989, 0.9562095471495236, 0.9551194654718275, 0.9566831553746238, 0.9567531424198694, 0.9581303309183112, 0.9573353835800642, 0.9561308713148768, 0.951387568910558, 0.9494153444328389, 0.9491789709151617, 0.949019058744213, 0.949825332265458, 0.9494620101521969], [0.8297257936551065, 0.9112332504667449, 0.9135425206721501, 0.9042696375779896, 0.9123830893565185, 0.9185574141340063, 0.9298861557038154, 0.9309193733767497, 0.9325155278378026, 0.9231833181886413, 0.9235388758653462, 0.9229714106331648, 0.925087469850407, 0.9256732614988221, 0.9250219846114808, 0.9253301393232914, 0.9269625213368471, 0.9260120914969366, 0.9266376546975559, 0.9168167196140222, 0.919966335153059, 0.9213855416468004, 0.9199270912630327, 0.9191692896202235, 0.9213505899341903, 0.9222114983416443, 0.9227816491380442, 0.922265816043734, 0.9227964709323506, 0.9227258980849644, 0.9230445824136655, 0.9234431327445254, 0.9232567341113438, 0.9236183480897606, 0.924244769725863, 0.9216949485718389, 0.9210530593459287, 0.9213219229143839, 0.921514551111485, 0.922145225547229, 0.9267805723921794, 0.9255219169604642, 0.9264008525130659, 0.9263637035206409, 0.9260865154906651, 0.9260375059125727, 0.9265529216024737, 0.9263171274890101, 0.9265966073054592, 0.926636701755414], [0.9076479147769899, 0.9067808610581192, 0.9379585273301083, 0.9398765276560977, 0.9537100247148431, 0.9524142798175181, 0.9531964673351683, 0.9480749976079498, 0.9483284437076442, 0.9475790018097053, 0.9464493303162123, 0.952000901628838, 0.9511785779590435, 0.9519669551483498, 0.9507188900654995, 0.9471228197848728, 0.9589914265310476, 0.9587060165800672, 0.9584566163334602, 0.9596672693644521, 0.9589158287183742, 0.9600677927011908, 0.9592306234907839, 0.960689322777708, 0.9613866763320108, 0.9583724593654505, 0.9584665053010669, 0.9603882452203484, 0.9600522782247094, 0.961887411097617, 0.9613911976937282, 0.9625970231032074, 0.9618265218145952, 0.9614314225000238, 0.9615785158560045, 0.9623076478938224, 0.9626814299147346, 0.9623375565806913, 0.9628869382969686, 0.9628344711583223, 0.962650191415596, 0.9629276708497672, 0.9638486907683885, 0.9621909145549356, 0.9610683192746117, 0.9612174033192629, 0.9610736465831594, 0.9613354664704198, 0.962438033972013, 0.9620050873942952], [0.8609534536231391, 0.8028453389020476, 0.8131901439079761, 0.8183929818342945, 0.8194116795699484, 0.826855358546186, 0.9014752537300381, 0.9019466595353776, 0.8995449191290843, 0.928000534917088, 0.9217815604778443, 0.9132187327865591, 0.9116747995609975, 0.9105981530609234, 0.9093081769508824, 0.9082383251722742, 0.9107345403715944, 0.9090646935640468, 0.9086211267535222, 0.9075183663433577, 0.906921064558937, 0.9065298839947413, 0.9086357019591541, 0.9216842604185084, 0.9205161228178647, 0.9198136612768684, 0.9196772123560284, 0.9205583609892579, 0.9187747818102279, 0.9190201839137468, 0.918625878833851, 0.9184421397077819, 0.918140892387032, 0.9189063635277377, 0.9185169872613408, 0.9181475110794446, 0.9166266904686111, 0.9162329046744234, 0.9152069721446696, 0.9147041627561813, 0.9151546123026988, 0.9146003320189596, 0.9146056392949233, 0.9139005021123134, 0.9136039987745561, 0.9141515547484507, 0.9147448958791669, 0.9151011962864066, 0.9147451423198418, 0.9212120448795225], [0.8878938564635812, 0.8842501765091315, 0.9250208672356321, 0.9662716002925746, 0.9727042287050348, 0.9792688586298446, 0.9802766506960685, 0.9831277014628331, 0.9827858535124359, 0.9783982356892005, 0.9793771635349662, 0.9779759383360371, 0.9837193311663202, 0.9832701787607226, 0.9841361632517315, 0.9846325104354368, 0.9821012398435317, 0.9830648219450493, 0.981404562898303, 0.9789443903962628, 0.9822942357283586, 0.9841011392363032, 0.9839669053150382, 0.9846174540775298, 0.9846870556266032, 0.9850804474184026, 0.9861093646875112, 0.9864353459982466, 0.9865071386153297, 0.9867147278399184, 0.9870158963389684, 0.9865691747786343, 0.9861259093180286, 0.9856152664490834, 0.9855579596854069, 0.984281484803943, 0.9843255128686634, 0.9832226119144624, 0.983016668057926, 0.9834697726541219, 0.9817147602511886, 0.9825971405454539, 0.982559578198407, 0.9824167371005459, 0.9828513540436499, 0.9829937403915467, 0.9832638618703102, 0.9825174352789929, 0.9825502103491435, 0.9831189289226137], [0.9348673768354695, 0.933066175100441, 0.9583230069635824, 0.9433601282203149, 0.9461294930489829, 0.945091576542848, 0.9467563817740701, 0.9464112912508481, 0.9459134924895283, 0.9450102893458111, 0.9528462200119274, 0.9531073706452323, 0.9523250899635195, 0.9529113816285597, 0.9567787984250636, 0.9622836403186732, 0.9624910933121796, 0.9634264933218224, 0.963424290500834, 0.9646716378855178, 0.9656361399527256, 0.9658715082727718, 0.96647514327489, 0.966343610041364, 0.9663890626152796, 0.9662913007993014, 0.9660814200488603, 0.963997582419478, 0.9637325690930316, 0.9641141457779772, 0.9635057250696976, 0.9633995242775384, 0.9623074912853609, 0.9595062708728923, 0.9593282767318997, 0.9589763372969426, 0.9589149608093326, 0.9594417452820383, 0.9605945032232235, 0.9608355414803912, 0.9607171863907361, 0.960888742709826, 0.9609929501041189, 0.9629143762240782, 0.9626643095034226, 0.9635758352771419, 0.9635325544985669, 0.9633088440656531, 0.9632986598967876, 0.9633321288142699], [0.8593543650545363, 0.8837058738925558, 0.8829218404272867, 0.8571863626428007, 0.8802182344437771, 0.8822482690027782, 0.8819089196025837, 0.8874666293963591, 0.8794003732989667, 0.884028646673422, 0.8872824907833184, 0.9067666247646566, 0.8983763607657423, 0.89773205845046, 0.896998453661442, 0.8992768856107631, 0.8980819307536105, 0.8927919333619903, 0.9006932358454767, 0.8996672568701556, 0.9023453478611692, 0.9033702786090916, 0.9015920380222142, 0.9020335042729487, 0.9016238180017211, 0.9011852039046064, 0.9078586908208596, 0.907253075409804, 0.9072471760835137, 0.9089424116868418, 0.9086039805013452, 0.9080081322944236, 0.9085663255729295, 0.9082298039489732, 0.9078123656704714, 0.908802599278917, 0.9092827768112599, 0.9090029651021534, 0.9075243631612262, 0.9085114033327131, 0.9087991295649693, 0.9086109768097972, 0.9077542256159149, 0.9067264020854037, 0.9074053121564314, 0.9074687177253629, 0.9057464313545129, 0.9095689022621396, 0.9087789044642298, 0.9086683611655313], [0.8844942957939315, 0.9315557526753366, 0.9313728865577022, 0.9488763197778793, 0.9306167716338933, 0.9411146890950577, 0.9581174414250679, 0.9569477711289677, 0.9571652862255626, 0.9585258481854673, 0.9560779465568741, 0.9545755265835173, 0.9529247794248201, 0.955757899409109, 0.9557378866367785, 0.9570393692577848, 0.9585510017092134, 0.957965364792594, 0.9595755125918697, 0.9604447947911077, 0.961426890544347, 0.9610409018619865, 0.9613511312750141, 0.9609782302854777, 0.9615502685783218, 0.9608613292838675, 0.961228932312465, 0.9613497085288272, 0.9603717552465298, 0.9609217606246676, 0.9614815837375427, 0.9610545397881426, 0.9608106763754237, 0.9625277266506205, 0.9623283378120755, 0.9625047976416308, 0.9622563908736853, 0.9615313248307505, 0.9613575925864265, 0.9614153277839, 0.9606826685209844, 0.9606774020019501, 0.9626073768556579, 0.9619636431596611, 0.9615546311425966, 0.9614626399899713, 0.9613856937887367, 0.9614131189900961, 0.9612076068406141, 0.9606399389725206]]).mean(dim=0)
    mnist_random_p_x = torch.tensor( [[0.9396261522184987, 0.9381016044942788, 0.9532020345739133, 0.923366064494803, 0.9326865858947982, 0.9316490030089726, 0.9394466343204001, 0.9393574454362946, 0.9417359666182906, 0.9429602720527804, 0.9461996640740705, 0.9476332682462021, 0.9466455761504882, 0.9459681449326642, 0.9461714276657934, 0.9478935413016498, 0.948881815591349, 0.9509988022975963, 0.9534242871277232, 0.9539464181000229, 0.9548314338176431, 0.9566463912220672, 0.956988915349965, 0.9576006718518588, 0.958292544714924, 0.9594105997471337, 0.9596476820755087, 0.960621239795029, 0.9613826686672577, 0.9617670622459169, 0.9622321058635667, 0.9629914161965719, 0.9638566534907543, 0.9635557238886807, 0.9643103119815843, 0.9654010038964951, 0.9658009064760348, 0.9669953582967334, 0.9668540145347961, 0.9675213705622667, 0.9695908114263977, 0.9685553470797958, 0.9690549988954487, 0.9698225084604107, 0.9700444375731179, 0.9695758037592266, 0.9696453112522249, 0.9696235436660043, 0.9695532760864143, 0.9690209728914307], [0.9922770096357796, 0.9936672315778823, 0.9933558413779229, 0.9935554170243899, 0.9939520580210314, 0.9943965081069452, 0.9944164202877042, 0.993875884001903, 0.994023807111102, 0.99401041886421, 0.9940278632960715, 0.9940962936893492, 0.9943277798819041, 0.9941233963798265, 0.9941523853381394, 0.9943073854973377, 0.9946626987911789, 0.9946549551653283, 0.9947412412819501, 0.9946405315984964, 0.9946135707326683, 0.994553720730672, 0.9946822989577094, 0.9946586142412795, 0.9942749218351175, 0.9941303741525712, 0.9944108182140574, 0.9944681862846912, 0.9943634771461278, 0.9943463447284948, 0.9946797886614172, 0.9945048195916003, 0.9945518770102314, 0.9945354820807747, 0.9944678459055329, 0.9945100812860885, 0.9945098969140446, 0.9945225476727603, 0.9945598475555211, 0.9946263491335684, 0.9945228455045237, 0.9945388433249626, 0.9944847088563324, 0.9944951187855896, 0.99444973489782, 0.9944472529664576, 0.9943900550854029, 0.994326418365271, 0.9941596042127878, 0.9940203040422649], [0.6912447836506818, 0.7273750844273519, 0.7272415077464017, 0.7493934917430357, 0.7597840997306936, 0.7565895778816947, 0.7470493024978192, 0.7597070232484323, 0.7645337918553595, 0.7659410374137734, 0.7780234987924889, 0.7767028796954834, 0.7781909848196853, 0.7778403729443708, 0.7799605144501489, 0.7892651314114038, 0.7924923169571951, 0.7902505170214154, 0.7885820695373812, 0.7905610989519319, 0.7933574589489302, 0.7846143530804142, 0.7887220590062609, 0.7867274359059532, 0.7842985117410919, 0.7864757685810915, 0.7852323028582887, 0.7874881432626051, 0.7917266270027276, 0.7917336856829666, 0.7929075641986199, 0.7932838272256526, 0.793346263482233, 0.795998005115467, 0.7967017970569455, 0.7981670345177154, 0.8011850893607388, 0.8018487129519247, 0.8042393910650334, 0.806491786710366, 0.8088557064277972, 0.809990185512574, 0.8119913444279179, 0.809404868674715, 0.8080919541502578, 0.8092213891236657, 0.8126265795142644, 0.8115556900651921, 0.8133876713306244, 0.8151096971195665], [0.8380060024329165, 0.8232408569926815, 0.8409468842650981, 0.8540980371124498, 0.8488138863043942, 0.8541785252834452, 0.8595389744672934, 0.848842395813103, 0.8533726985069051, 0.8580243477504816, 0.8571883575987055, 0.8552288722882694, 0.8605228517888299, 0.8643023778347863, 0.8671678354777681, 0.8677891380031909, 0.8638701043778793, 0.8638340973409132, 0.8652501693638078, 0.8660825682625533, 0.8685922870910676, 0.8719655447623701, 0.8724173180931896, 0.8725254494618555, 0.8739627539807386, 0.875873993641907, 0.876535492999498, 0.8750088324348113, 0.8761018334449299, 0.8775035719579211, 0.8757322336538526, 0.8768046794657034, 0.8776917819687281, 0.8788917645164985, 0.8808768453803333, 0.8817851488771269, 0.8833308367824325, 0.8844680196554947, 0.8849341895006568, 0.8856897387347669, 0.8862123133040646, 0.8869199476622125, 0.8863419449375854, 0.8857814731981478, 0.8859526562592784, 0.8855249663753184, 0.8853046871049918, 0.8864053746566849, 0.8816750958730675, 0.8808993537162144], [0.8363108125568838, 0.8253612995164061, 0.8328599094193133, 0.8474477565921937, 0.8510253545714722, 0.8515312151589185, 0.8468565945922385, 0.8521314037633722, 0.8564551311991173, 0.8631020648486741, 0.8645416470767858, 0.8673865749116617, 0.8729240421547589, 0.8768836911694275, 0.8740925844638726, 0.8753644169187452, 0.874459564293538, 0.8771019093331738, 0.880385240005808, 0.8796928510839791, 0.8793019507523931, 0.880252710109049, 0.8820907363310773, 0.8840911608393917, 0.8843965663312294, 0.8834981451617271, 0.885962730568493, 0.8868744337417571, 0.8878100574169416, 0.8872770847781275, 0.8887164735789996, 0.8904093004200982, 0.8909242198499159, 0.892151257779966, 0.892112491737433, 0.8941965090509764, 0.8939422811828566, 0.8940026627193756, 0.8906730545797509, 0.8914912518017749, 0.891819481707844, 0.8920732260078654, 0.891715901421226, 0.8924907064659116, 0.8927651635994696, 0.8933987989973763, 0.894488487468623, 0.8933932540831846, 0.8947035140829216, 0.8957761970760506], [0.7689879195485263, 0.7991906677000274, 0.8074173679136072, 0.7850029020149764, 0.8053225517650398, 0.7996733569676981, 0.809094414309444, 0.8041385627481262, 0.8092957915466764, 0.8110931538005974, 0.8150555325896317, 0.8068506775815947, 0.8128565072413776, 0.8156317460934401, 0.8208150623977226, 0.8196210749305688, 0.820947119393677, 0.8123656502256235, 0.812280681001487, 0.8144542877544121, 0.8180459141509123, 0.8218800029657375, 0.8222847641714127, 0.8257449144678349, 0.823208459026879, 0.824705586127108, 0.8269150499982361, 0.825777779092128, 0.8248611606046133, 0.8247969980146035, 0.8286312980642929, 0.8304003020376911, 0.8319921327687166, 0.8329259845005712, 0.8346295584747744, 0.8371171658533773, 0.836804485445601, 0.8385442685961141, 0.8334781348327629, 0.8331857153690474, 0.8323739573887176, 0.833975487320592, 0.8357456002770273, 0.8374049205471742, 0.8376481926991457, 0.8378632473938371, 0.8390520948126281, 0.8397742011959979, 0.8399254981675023, 0.8395316155573351], [0.8641111692015148, 0.91717050206645, 0.9216733369942636, 0.9091792553583437, 0.9007207241233378, 0.9042554377181724, 0.9074605154661951, 0.9084614118693245, 0.9130674667708414, 0.9176115268499592, 0.9096050005430542, 0.9055121020375577, 0.9073496060840055, 0.9086615845354057, 0.9094965881515774, 0.9118205258325098, 0.9114899804857696, 0.9127514899593191, 0.9135662530679913, 0.914862869238781, 0.9161279009575082, 0.9187392075431212, 0.9186981146827154, 0.9193410153776262, 0.9217770365224744, 0.9227380306832865, 0.9221298894220065, 0.9229689609833129, 0.9237562075850574, 0.9252059339347191, 0.9260683713760066, 0.9252699131205979, 0.9233834449052725, 0.9247517627431523, 0.9208702320210386, 0.9211337389548676, 0.9205408938287487, 0.9190079399674485, 0.9195014015559262, 0.9186954192556546, 0.9182909563692708, 0.9185936710181994, 0.9192303375045096, 0.9196379257633747, 0.9196429693538872, 0.9195764601045706, 0.9193543106129448, 0.9194555792958922, 0.9200383041682614, 0.9203603663611231], [0.8789494641219099, 0.901289869586172, 0.916132074072617, 0.9210912756561166, 0.9159187262060429, 0.9201970854630631, 0.9213889357203805, 0.919694826764883, 0.9216351087222466, 0.9237931286753369, 0.92640027590488, 0.9272668998099307, 0.9263561419209926, 0.9268183930464325, 0.9253813315823285, 0.9238382089414802, 0.9252845780999012, 0.9254601057018997, 0.9251518658917618, 0.9246498553987637, 0.9256266513788822, 0.926065633268529, 0.9266568735243813, 0.926146672260384, 0.9256575063855436, 0.9260773609633686, 0.92697246641303, 0.9280055894565912, 0.9292284188231612, 0.9295724932564203, 0.9296913525128511, 0.9294329088673101, 0.9305492582108912, 0.9313268850454455, 0.9310756238373527, 0.9316731778125169, 0.9311918459137268, 0.9318785365748021, 0.9320411109688758, 0.9321976663872911, 0.9330005791247405, 0.9333049717545604, 0.933657236958819, 0.9335347166759567, 0.9334211783181108, 0.9320060519869476, 0.9323714100145455, 0.9319567367198903, 0.9324389373368167, 0.9326044436546004], [0.7395007187264606, 0.7149227277639685, 0.743295545683619, 0.7564772083672925, 0.7688136747358507, 0.777821832220235, 0.7724165704437252, 0.7812491132727528, 0.7814814622203408, 0.780854492223209, 0.7843959731816302, 0.7906670870410653, 0.7909917450060903, 0.794058110801699, 0.7976223277311403, 0.8020053483974716, 0.803917737714003, 0.8071625946959694, 0.8071050153211843, 0.8115627607871945, 0.8089292722782856, 0.8060541389136952, 0.8069318709071392, 0.8048336121834903, 0.8051172998962336, 0.8063261579865584, 0.8097244137036635, 0.8094772595597932, 0.8090755040633031, 0.8098284076125688, 0.8109301514891735, 0.8120508772200685, 0.8133489890293658, 0.8147982243515413, 0.8162336945790392, 0.8171658856424537, 0.8193666593805383, 0.819712883202278, 0.8191657247517367, 0.8185712741813467, 0.8189408677860219, 0.8192555147730994, 0.8202414660882184, 0.820471409800845, 0.8211753635683285, 0.8223448115587791, 0.8233847018930663, 0.8250185389985284, 0.8252844637260501, 0.8259386713839609], [0.8746741243091546, 0.8857230611498828, 0.8976312423617787, 0.8970271804890152, 0.900710961204494, 0.9026592116652988, 0.903268194196145, 0.8994267952124922, 0.905351126055658, 0.9075365585244365, 0.9092315444430223, 0.910148846291187, 0.9088111504564624, 0.9097330585436632, 0.910663770364175, 0.9122023328069645, 0.9104475286647199, 0.9112860842626066, 0.9117619732109313, 0.9124167194340432, 0.9138330829142834, 0.9136798193499078, 0.9139749016253546, 0.9151079578234518, 0.9157503945408805, 0.9152366338183655, 0.9146532921607881, 0.9152375456336013, 0.9155730779194227, 0.9157318123752128, 0.9165840609225893, 0.9180897665749853, 0.9178177626575754, 0.9185313209633962, 0.9182726484135719, 0.9185946921222843, 0.9187428935400059, 0.9192095071264492, 0.9198233631525214, 0.9199142459780066, 0.9206562120447083, 0.9203388374588414, 0.9202455336066956, 0.9207766974234521, 0.9206887544160549, 0.9202282248381678, 0.9202597925104692, 0.9201371848031591, 0.9205890992991631, 0.9209522375772956]]).mean(dim=0)
    mnist_random_cossim = torch.tensor( [[0.8954426178287852, 0.920596624309898, 0.9710548756643884, 0.9746692733863281, 0.9794453502592217, 0.9821759451676768, 0.9836824691364413, 0.9886982805547533, 0.9882292909556487, 0.9887924504318424, 0.9844652370354293, 0.9865796847290194, 0.9905267416252204, 0.9903952304728094, 0.9902344964167578, 0.9902355233422593, 0.9899632587079239, 0.9892297428028695, 0.9906792036750672, 0.9897224406348113, 0.9900724039080742, 0.9914525270938526, 0.9915161317867243, 0.9918202391976333, 0.9921321738832307, 0.9922614937221699, 0.9921883151726545, 0.9921061934766457, 0.9923077700579573, 0.992427402835867, 0.992724709897589, 0.9928939261965622, 0.9927009369765308, 0.9930590347935297, 0.9932178686331024, 0.9930645252062503, 0.9932014620831612, 0.9932740180085537, 0.9930315908159545, 0.9929647759701373, 0.9933767509888403, 0.9934012920825175, 0.9930486846782391, 0.9930886781706042, 0.9930409867799918, 0.9927205779375002, 0.9930384720254173, 0.9933045346766058, 0.9931490888825854, 0.9929939827017229], [0.9969416719892276, 0.9985344124392698, 0.9982030816936217, 0.9976717143713967, 0.9979945852767151, 0.9981067118444359, 0.9982206254027377, 0.9980856650664828, 0.9980191067585757, 0.998067894437928, 0.9980561371745027, 0.9980677526132786, 0.9982269862382579, 0.9982014081627603, 0.9981981745607567, 0.9982576203625024, 0.9982162572035398, 0.9982638890120006, 0.9983791853606327, 0.9984019978554695, 0.9983815751059731, 0.9983943889630356, 0.9984234913810679, 0.9984086636139856, 0.998352947800516, 0.9983795115573262, 0.998388496148858, 0.9983417649269202, 0.9983253416325335, 0.9984300862272594, 0.9984641241430866, 0.9984721939656307, 0.9984315824773093, 0.9984507500786595, 0.9984293983777104, 0.9984583944272556, 0.9984678541313627, 0.9984501118677378, 0.9984065078793166, 0.9983988706219529, 0.9984060327667414, 0.9984154711971511, 0.9984113228261596, 0.9984105995204483, 0.998406727707523, 0.998403593382774, 0.9984068978971021, 0.9984022602310707, 0.9983869573514134, 0.9983918219368836], [0.7411882911411872, 0.7690664872316317, 0.7974126323002747, 0.8269579379549695, 0.845861552675901, 0.8437665932809976, 0.8345598828289836, 0.8375235443125183, 0.8403667622587284, 0.8384282241406249, 0.8550871400995783, 0.8521176655852583, 0.853801591417137, 0.8553336633535467, 0.8551217260949104, 0.8541070754119255, 0.8562694844180018, 0.8566201193608988, 0.8587460585190735, 0.8569522848594231, 0.8682247665253084, 0.8670701186842498, 0.8675252420865889, 0.860400357885853, 0.8585570735050053, 0.8628459060884885, 0.8650366882210159, 0.861756470303102, 0.8582575563248851, 0.8574246628134577, 0.8550742683885542, 0.8544527738921717, 0.8559262695474693, 0.8568234062761049, 0.8579385470375689, 0.8572293419034016, 0.8594147185324342, 0.8569012978129471, 0.8595409135869906, 0.8580392139675134, 0.8576243204290201, 0.8600207808161372, 0.859591108646468, 0.8603364068580232, 0.8670344177557643, 0.8639737032635401, 0.860975840244381, 0.8616825771472229, 0.8620834763523447, 0.8644000767689145], [0.7371899689372364, 0.8043834944750619, 0.8753578849031756, 0.8720301400635935, 0.8879091567344106, 0.8950718321486136, 0.9080106442849698, 0.8970193859933886, 0.8969025048832378, 0.9053571414507938, 0.9031482373169307, 0.899755038740642, 0.9015403561546438, 0.8993346022427375, 0.8965420092336156, 0.8975904346030461, 0.8995844935994577, 0.8965727002710293, 0.9001231894296191, 0.8992929326818043, 0.9019799538776004, 0.90325466756574, 0.9030005785382623, 0.9021466084946681, 0.9000051427373443, 0.896148530760106, 0.9001968258678585, 0.8987717520857226, 0.9070734532528326, 0.9067337963214542, 0.9055397676931822, 0.9013656842226961, 0.9002288006207197, 0.9012720044972569, 0.9011542176982934, 0.9033790540797026, 0.9067739301491834, 0.9075781660636354, 0.9070202932573123, 0.9080887146606132, 0.9078573859867731, 0.9087875756506114, 0.9084928015065621, 0.9093997582834692, 0.9099941815400459, 0.9089618223025948, 0.9100711178357849, 0.9096930596987537, 0.909196868238344, 0.9070770523814182], [0.8404880188588979, 0.8329215482328876, 0.8520499547767114, 0.8668013446803771, 0.8887292800741317, 0.8828010011536, 0.8972194705406447, 0.909574151879584, 0.9146105458594063, 0.9161250489048536, 0.9195286107256178, 0.9181633126168461, 0.9177018274618709, 0.916609431009275, 0.9185942443274884, 0.9210484410796129, 0.9220290768852644, 0.9238011041213672, 0.9262077338915728, 0.9255349778345279, 0.9247101396106232, 0.9243314090761735, 0.9243308771512655, 0.9273890262795405, 0.9266798253068337, 0.9259173593081186, 0.9220820517704137, 0.9222033628872961, 0.9216769990124896, 0.9249148259270903, 0.9302239845521268, 0.9317165900221978, 0.9309115619713795, 0.930413809209045, 0.9310005143230292, 0.9310542065008574, 0.9309901014899828, 0.9292073551610385, 0.92825428273698, 0.9284511433097258, 0.9271004892548589, 0.9276892334143235, 0.9261511483646243, 0.9264637912589972, 0.9270312342437395, 0.9271988873033586, 0.9295642687147946, 0.9290273791743855, 0.9293707125240527, 0.9291208690066892], [0.7973336756042251, 0.855961832958145, 0.8531313033803705, 0.8587478271853779, 0.8550831223273069, 0.8721279363670461, 0.8654861577441412, 0.8693405427088379, 0.8770276610646477, 0.8848292687168701, 0.8829674798293589, 0.8835614986719312, 0.8888481880378964, 0.8852889509872448, 0.8851492983376308, 0.8799272732444781, 0.8768799110785716, 0.8767322843128329, 0.8762643638827532, 0.8768065333676096, 0.8771456093319621, 0.8797302527263204, 0.8829800835095912, 0.8915026973635988, 0.8939984108801163, 0.8939955416065439, 0.8958183576616048, 0.8958810416075649, 0.895637646235256, 0.8964813094815374, 0.8972948629582134, 0.8961948926085471, 0.8959581423330089, 0.8971452734685279, 0.8983141063839329, 0.9028363631806083, 0.9045853614520736, 0.9041705225830842, 0.904352017338721, 0.9046203472264616, 0.903073051845978, 0.9037874129509926, 0.9047700511350317, 0.9053675289485059, 0.905863499608265, 0.9073836425072423, 0.9073985169622653, 0.9047050700099231, 0.9050068454178336, 0.9054967694796039], [0.9348221014832587, 0.9712874345209661, 0.9723059752227085, 0.9656625660677285, 0.9655685155069408, 0.9824751187277743, 0.9790313220530649, 0.9788792867377448, 0.9802890446996394, 0.9805906844850161, 0.9806647177791956, 0.9763349358832315, 0.9754737469373004, 0.9768017987328914, 0.9759947002281621, 0.9768364589483483, 0.9776528839614351, 0.9760543634234715, 0.9748579410720775, 0.974074977388178, 0.9730000146181442, 0.974858056826614, 0.9741759732211472, 0.9752250152432188, 0.9748207590613642, 0.9745321003204219, 0.9729916968278892, 0.9735425147891303, 0.9731071785142646, 0.9732418258445882, 0.9729268412148061, 0.9743522756481957, 0.9733366040053186, 0.9740367287820942, 0.9735942570668805, 0.9737392561600265, 0.9741637032402934, 0.9731422190660554, 0.9727407492612545, 0.9720918624031779, 0.9722074019668216, 0.9722379115553322, 0.9724186705320303, 0.9725718468563515, 0.9727860836985995, 0.9725305638277789, 0.9726972917010347, 0.9729038143302529, 0.9728581657020234, 0.9725999752086856], [0.9059591209788667, 0.9348801904279795, 0.945940740764642, 0.9424645651423497, 0.9437575047163638, 0.9376336856378368, 0.9428977142102244, 0.9450427266605066, 0.9465444688437032, 0.9464125943280525, 0.9477261426885671, 0.9484604887445466, 0.9487463978447352, 0.9507698052687631, 0.9510344230182011, 0.9509243440200763, 0.9511910017058521, 0.9515365265881424, 0.9526398451596794, 0.9546559460436683, 0.9552970057333535, 0.9549797684853757, 0.9552810507940115, 0.9551447163415002, 0.9544210663775737, 0.9530918267957227, 0.9524650466604025, 0.9529344879797024, 0.9555986448369382, 0.9552742018822764, 0.9550573868995691, 0.9541534236274828, 0.9545991148134498, 0.9569265348031135, 0.9568469617731132, 0.9575993492432441, 0.9576970722771628, 0.9580693102421434, 0.95893571696766, 0.959191562215204, 0.9587040562125166, 0.9584467682723534, 0.9582577134879474, 0.9584350716031615, 0.9585101614270656, 0.9586810584511414, 0.958705157623011, 0.9585083309138498, 0.9585168009156785, 0.9587042889048747], [0.6668511492716445, 0.7040933767467409, 0.7733113097235687, 0.7801377403305085, 0.7862391957414339, 0.8052956041893343, 0.8104259297330108, 0.8110142778322658, 0.8059708739047445, 0.8033964355392968, 0.8091789941729932, 0.8116137095142482, 0.8156767039180141, 0.8098267336990481, 0.8172985473518444, 0.8169793255428641, 0.8229824669747425, 0.8236711848788728, 0.8221783790504035, 0.8176065311880154, 0.8195311823273735, 0.8230205038154665, 0.8209454361072896, 0.8223591454590221, 0.827845689550798, 0.8280821338984552, 0.8286267977303033, 0.8301385610356812, 0.8294855884984264, 0.8315743887981057, 0.8311484509393012, 0.8266592992802984, 0.8274393511066112, 0.8296470073920346, 0.8302867105080328, 0.8293125740970821, 0.8328417038489447, 0.8346604921468266, 0.8355996957702806, 0.8345404010404267, 0.8337614705736567, 0.8330937903496449, 0.834383183182207, 0.8326046906957223, 0.8417855944302559, 0.8407938900531347, 0.842580345817532, 0.8432557699230243, 0.8436025219213601, 0.8416511287946442], [0.9037864432505534, 0.9163457470060468, 0.9315523883915355, 0.9226579923482352, 0.9247905080914327, 0.9292415420254542, 0.9326961584186533, 0.932784250775098, 0.934793773647653, 0.9346289237414017, 0.9339053040260825, 0.9393220131786227, 0.9381383276535105, 0.9375791490996814, 0.9366847605395544, 0.9384677916517279, 0.9373315283793532, 0.937486961435152, 0.9380528999984876, 0.9372391835053001, 0.9370684146604924, 0.9372837995680448, 0.9377270046564518, 0.9385921836871286, 0.9375744642558839, 0.9373308523784025, 0.9387287201582132, 0.9384892664726261, 0.9368335436325128, 0.9366104004349799, 0.9370657106566898, 0.9393926945803495, 0.9398504336891961, 0.9394729579025282, 0.9396232187650067, 0.9397671912465486, 0.9395321237066647, 0.9400768782867205, 0.9395318328690464, 0.9396565707653988, 0.9403438436389049, 0.9400062361873747, 0.9397019728757605, 0.9407433208983744, 0.9405615002240707, 0.9411356529850049, 0.9410691454961249, 0.9410639890237569, 0.9423211149777317, 0.9420560282793522]]).mean(dim=0)
    mnist_ocsvm = torch.tensor([0.9825580342284781, 0.9941058952181053, 0.8136368319781899, 0.8845586830434106, 0.9168753854037742, 0.7937241382515288, 0.9311778592924898, 0.9338088437864221, 0.8380246357816078, 0.9145391423258376] ).mean(dim=0).item()

    cifar_ent_max_gaussian_p_x = torch.tensor([[0.7109376203703703, 0.7077002407407407, 0.7121467407407408, 0.7177649074074074, 0.7148919629629631, 0.7162131666666667, 0.7212560925925927, 0.7193227407407409, 0.7196534444444446, 0.7203395], [0.46238412037037036, 0.4784261666666666, 0.4631875000000001, 0.46284714814814815, 0.46018427777777776, 0.45564875925925924, 0.4560152777777778, 0.4527142777777778, 0.4508873518518518, 0.44998607407407404], [0.6262478425925926, 0.6323402037037037, 0.6418937962962963, 0.6445249259259259, 0.6468197222222222, 0.6462385, 0.6475359074074074, 0.6522006111111112, 0.6529520925925926, 0.6534476481481482], [0.5158771388888889, 0.5034835925925926, 0.5043223148148148, 0.5056811296296296, 0.5052725, 0.5072783888888889, 0.5078550925925926, 0.5070215555555555, 0.5081392592592593, 0.5058447777777778], [0.7304262499999999, 0.7289748703703703, 0.736618648148148, 0.7341677407407408, 0.7340446666666667, 0.7348278888888888, 0.736312925925926, 0.7375482222222222, 0.7374256851851853, 0.7391488148148149], [0.4928024907407407, 0.47858840740740743, 0.4805168333333333, 0.48187262962962957, 0.4814400185185185, 0.48136194444444447, 0.47800966666666667, 0.4781656111111111, 0.4766876481481482, 0.47725094444444444], [0.7393309166666666, 0.7474746296296295, 0.748531037037037, 0.7534158888888889, 0.7518193148148147, 0.7518087592592593, 0.7511078703703703, 0.7503615555555555, 0.7504590185185186, 0.7512263888888888], [0.5357449629629629, 0.5350312037037037, 0.5375169444444444, 0.5330350740740741, 0.5357845, 0.5342730740740741, 0.5336690925925925, 0.5317535740740741, 0.532124111111111, 0.5333779444444444], [0.6892055833333333, 0.7013967777777779, 0.6959915370370371, 0.693377388888889, 0.6943151666666666, 0.6944323703703703, 0.6879192777777777, 0.6910485185185186, 0.6948821666666667, 0.694155925925926], [0.47030339814814814, 0.4711563518518519, 0.46834625925925927, 0.46988079629629625, 0.46980974074074067, 0.4684633333333333, 0.4762001851851852, 0.4751068888888889, 0.47908275925925925, 0.4797257592592593]]).mean(dim=0)
    cifar_ent_max_gaussian_cossim = torch.tensor([[0.7639813611111111, 0.7575343240740742, 0.7408785185185185, 0.7440085370370371, 0.7326691388888888, 0.7280210092592592, 0.7481246944444444, 0.7479714629629629, 0.7471110185185185, 0.7436841666666667], [0.59749675, 0.5867522407407407, 0.609104962962963, 0.6247394814814815, 0.634447324074074, 0.6347486111111111, 0.6380045185185185, 0.6435149166666666, 0.6439479351851852, 0.6519264722222222], [0.6611700185185185, 0.6530722592592593, 0.6556845092592591, 0.659655175925926, 0.671858824074074, 0.6784460277777777, 0.6780252962962964, 0.6770410648148149, 0.6844129722222222, 0.6793083425925927], [0.5142694814814815, 0.5398454907407407, 0.534028712962963, 0.5358909999999999, 0.5376509444444444, 0.5364128703703703, 0.5412184074074075, 0.5378419629629629, 0.531437462962963, 0.5328908148148148], [0.6539560092592592, 0.6855031851851853, 0.6586736666666667, 0.6648834537037037, 0.6670761944444445, 0.683812185185185, 0.6768844629629629, 0.6702355277777778, 0.6770000648148148, 0.6736193796296296], [0.5158154351851852, 0.5409864999999999, 0.5364351111111111, 0.5214209999999999, 0.526063675925926, 0.527977138888889, 0.5482510092592592, 0.5547669814814815, 0.5542667314814814, 0.5518063796296296], [0.6292111944444445, 0.6677058703703703, 0.6614677685185184, 0.673500037037037, 0.6941826203703703, 0.6690450555555556, 0.6720408981481482, 0.6859676203703704, 0.6869004351851852, 0.6874960925925926], [0.5871230000000001, 0.594480462962963, 0.5962524351851852, 0.5829744351851852, 0.5929080555555556, 0.5933577685185185, 0.5987967222222222, 0.596984037037037, 0.593106462962963, 0.5980641296296296], [0.7097981111111111, 0.7005384444444445, 0.7317088055555555, 0.7324949444444445, 0.7228485092592593, 0.7168597870370371, 0.7222543055555555, 0.7273944259259258, 0.7293090833333333, 0.7381272129629628], [0.6207055462962963, 0.663348574074074, 0.6619455740740742, 0.6632682777777777, 0.6706398055555556, 0.6727601296296296, 0.6648606018518519, 0.6659393240740741, 0.6638296759259259, 0.6637966203703703]]).mean(dim=0)
    cifar_ent_max_uniform_p_x = torch.tensor([[0.7493286666666666, 0.7490781111111111, 0.7729300555555555, 0.773800037037037, 0.7330755185185185, 0.739049314814815, 0.742192037037037, 0.7452559814814815, 0.7456056111111111, 0.7457337407407407], [0.49076650925925924, 0.477657, 0.485113537037037, 0.4866498888888888, 0.4852188703703704, 0.48475140740740735, 0.48470842592592595, 0.4843419074074074, 0.4838235925925926, 0.4854495370370371], [0.5853497777777777, 0.6271881944444444, 0.6203326666666666, 0.6226335555555556, 0.6260322592592593, 0.6302349444444444, 0.6303864814814815, 0.6327512037037036, 0.6297551851851853, 0.6292987037037038], [0.5265437685185186, 0.5276372407407407, 0.5226259629629629, 0.5181232962962963, 0.5154905, 0.5131518703703704, 0.511413425925926, 0.5107322777777777, 0.5093369259259259, 0.5096035555555556], [0.7213353333333332, 0.7196949814814815, 0.7210067222222222, 0.7277186481481481, 0.728674537037037, 0.730654611111111, 0.7324714259259258, 0.7316692037037036, 0.7320260555555556, 0.7304531111111111], [0.47410906481481474, 0.47815772222222225, 0.4817298888888889, 0.47832861111111113, 0.47836596296296297, 0.4797518148148148, 0.47886416666666665, 0.4793437962962962, 0.4807622407407407, 0.4794339629629629], [0.7552648703703703, 0.7611603333333333, 0.7657033148148148, 0.7652346666666667, 0.7663017777777779, 0.7662919074074074, 0.7664795, 0.7657191481481481, 0.7642502222222223, 0.7640172222222222], [0.5656924722222223, 0.5950299259259259, 0.5931932222222223, 0.593735, 0.6010925555555556, 0.6055221111111111, 0.6072397777777778, 0.6004437777777778, 0.6001142222222222, 0.6025879814814814], [0.5222212685185185, 0.5760791944444444, 0.6202829259259259, 0.6454892962962964, 0.6548181481481481, 0.655218537037037, 0.6586191666666665, 0.6599996481481482, 0.6647147037037037, 0.6700852592592592], [0.47913225000000004, 0.4757893148148148, 0.4722388703703703, 0.47032018518518515, 0.4654775740740741, 0.46728644444444445, 0.4664169444444445, 0.46189677777777777, 0.462694962962963, 0.46232983333333333]]).mean(dim=0)
    cifar_ent_max_uniform_cossim = torch.tensor([[0.5470659722222223, 0.5219684907407407, 0.5241490925925926, 0.5514667407407408, 0.5960411203703704, 0.5969366203703704, 0.5772547777777777, 0.5728077407407407, 0.5818717407407408, 0.5913755462962963], [0.4789315925925926, 0.47170487037037034, 0.4711109074074074, 0.48278012962962963, 0.4747344166666667, 0.47191019444444443, 0.46899607407407407, 0.46055001851851857, 0.4520565, 0.4522472777777778], [0.5849694074074074, 0.6006424351851851, 0.5718268888888889, 0.5882448796296296, 0.5895828518518519, 0.5810604537037036, 0.5757310185185185, 0.5860405648148148, 0.5896275, 0.5856287592592593], [0.43510040740740746, 0.4434168055555555, 0.4409470555555556, 0.44451488888888885, 0.4454193425925926, 0.44656263888888886, 0.45605440740740744, 0.45076337962962965, 0.451496962962963, 0.44806817592592596], [0.5078616203703703, 0.5513801759259259, 0.5817836666666668, 0.6063590555555555, 0.5989043055555555, 0.5989705092592592, 0.5961703796296296, 0.5971914814814815, 0.5988162592592592, 0.5922403518518519], [0.47999529629629634, 0.45600409259259256, 0.4476267407407407, 0.44424300925925925, 0.45530591666666664, 0.4569245648148148, 0.46958611111111115, 0.47241666666666665, 0.47244780555555554, 0.46850701851851856], [0.5970855925925925, 0.543430537037037, 0.5044435185185185, 0.4965111574074074, 0.4953023888888889, 0.4680553148148148, 0.46976527777777777, 0.47127955555555556, 0.47249331481481477, 0.4646831388888889], [0.481600712962963, 0.45119250925925924, 0.46340134259259264, 0.46451044444444445, 0.44581836111111106, 0.4420273425925926, 0.45481613888888894, 0.46021071296296295, 0.45804669444444446, 0.4587968796296296], [0.5343408703703704, 0.5519803611111112, 0.4724606574074074, 0.5030650370370371, 0.5063429444444445, 0.4921744537037037, 0.49969485185185186, 0.49100979629629626, 0.47616148148148146, 0.4787829259259259], [0.5799000555555556, 0.5368815092592593, 0.541428138888889, 0.5415900092592593, 0.5627823055555556, 0.5642640648148148, 0.5469461666666667, 0.5540007314814815, 0.5464751203703704, 0.5317240185185185]]).mean(dim=0)
    cifar_random_p_x = torch.tensor([[0.623247, 0.6396153703703703, 0.6400038703703704, 0.641702074074074, 0.6389384814814816, 0.6379056666666667, 0.6337089074074074, 0.6370693333333333, 0.635184462962963, 0.631647074074074], [0.40467414814814817, 0.3971008333333333, 0.38770594444444445, 0.38775262962962964, 0.38486905555555556, 0.3825638518518518, 0.38594994444444447, 0.387457, 0.3856857407407408, 0.38724581481481485], [0.6449545740740742, 0.6449479629629631, 0.6469367962962963, 0.6463491296296296, 0.6471857222222223, 0.6469347222222223, 0.6471925555555555, 0.6483349814814815, 0.6494743703703704, 0.6503927037037038], [0.5115963425925926, 0.5155525925925926, 0.5170785740740741, 0.5142570925925927, 0.5112090740740741, 0.5099146666666667, 0.5122796111111111, 0.5119959629629629, 0.5118803888888889, 0.5112541666666667], [0.7269025648148146, 0.7304437222222222, 0.7358920925925926, 0.7376498888888888, 0.7376928148148149, 0.7410315185185186, 0.7406027037037038, 0.7421555370370371, 0.7439985185185185, 0.7446006851851852], [0.5126363703703704, 0.503516111111111, 0.5011560185185185, 0.5062017777777778, 0.5058212592592592, 0.5064611666666666, 0.5035548148148148, 0.5009808333333333, 0.5000182777777777, 0.5011455185185185], [0.6882602592592593, 0.6931506481481482, 0.7027519999999999, 0.70494, 0.7066755740740741, 0.7061356666666667, 0.7084760185185185, 0.7110072222222222, 0.711646611111111, 0.7145224074074074], [0.496293, 0.49611759259259264, 0.5016927777777778, 0.4999996481481481, 0.5026862222222223, 0.5044993703703704, 0.5035782407407408, 0.5044341851851852, 0.5044810555555556, 0.5020454259259259], [0.637944962962963, 0.6411463148148148, 0.6480782037037037, 0.6499215555555555, 0.6539172592592593, 0.6588083703703704, 0.6630748148148148, 0.6647164814814815, 0.666632962962963, 0.6677610185185185], [0.43982249074074076, 0.44172057407407406, 0.44845761111111115, 0.4492269814814815, 0.44124577777777785, 0.44136437037037035, 0.4399577037037037, 0.43921716666666666, 0.44177187037037036, 0.43990153703703705]]).mean(dim=0)
    cifar_random_cossim = torch.tensor([[0.7247744166666666, 0.694469287037037, 0.676214537037037, 0.6816276481481481, 0.6733366481481482, 0.6554274722222222, 0.659506212962963, 0.6746743148148149, 0.6651938796296297, 0.6650627037037037], [0.531537037037037, 0.5565415185185185, 0.5476151203703703, 0.5477577037037037, 0.5638743703703704, 0.5708920462962963, 0.568644212962963, 0.580118212962963, 0.5825740185185185, 0.5815987685185184], [0.5829377777777778, 0.5858125092592593, 0.5977595648148147, 0.5924610648148148, 0.595204824074074, 0.5986447314814815, 0.5949121388888889, 0.5939009444444444, 0.5993086203703704, 0.5987886388888889], [0.5552404444444444, 0.5592016388888889, 0.5593102777777779, 0.5660909074074074, 0.5672271388888889, 0.5775502962962963, 0.578299462962963, 0.5856043148148148, 0.5878202685185184, 0.5864646574074074], [0.6625745925925927, 0.6582412592592592, 0.6416943425925926, 0.6386066851851853, 0.6400644259259259, 0.6423212037037037, 0.6368116388888889, 0.641136212962963, 0.6435205555555554, 0.6457201574074074], [0.5858322407407408, 0.5823803240740741, 0.5701914444444445, 0.5856143888888888, 0.5839431944444444, 0.5804016944444444, 0.5745251111111112, 0.5745740555555556, 0.5722484537037038, 0.5740162962962962], [0.6551639351851851, 0.6756614444444444, 0.6968678611111112, 0.7003389629629629, 0.7065263333333334, 0.7151548703703703, 0.7069150092592593, 0.7012180555555556, 0.7065931574074074, 0.7086774907407407], [0.5777629722222223, 0.5845195462962963, 0.5687524351851853, 0.5790103425925925, 0.5789422685185185, 0.5715365185185185, 0.5750603055555555, 0.5690212962962963, 0.5712423518518519, 0.5692339629629629], [0.6926127777777777, 0.7152503425925926, 0.7127397314814815, 0.7156982037037037, 0.7136716574074073, 0.7297876296296296, 0.7333168703703704, 0.7349573703703703, 0.7347713611111112, 0.7361746111111112], [0.5598751018518519, 0.5942266851851852, 0.6140130648148148, 0.6252555833333333, 0.6262744074074074, 0.6269969537037037, 0.6215030092592593, 0.6313725092592593, 0.6376808703703705, 0.6324586574074074]]).mean(dim=0)
    cifar_ocsvm = torch.tensor([0.6548333703703705, 0.41207862962962966, 0.6525573148148148, 0.49808648148148144, 0.749050037037037, 0.5150005555555556, 0.7153356666666667, 0.5151546666666666, 0.6800278148148149, 0.49463235185185184]).mean(dim=0).item()

    # config = {'num_workers': 20, 'batch_size': 64}
    # roc_list = []
    # for _class in range(10):
    #     config['class'] = _class
    #     inlier = [config['class']]
    #     outlier = list(range(10))
    #     outlier.remove(config['class'])
    #     cifar_train = MNIST(root='../', train=True, download=True)
    #     cifar_test = MNIST(root='../', train=False, download=True)
    #     train_dataset = OneClassDataset(cifar_train, one_class_labels=inlier)
    #     test_dataset = ConcatDataset([OneClassDataset(cifar_train, zero_class_labels=outlier), OneClassDataset(cifar_test, one_class_labels=inlier, zero_class_labels=outlier)])
    #
    #     dataloader = DataLoader(train_dataset, batch_size=config['batch_size'], shuffle=True, num_workers=config['num_workers'])
    #     train_x = []
    #     test_x = []
    #     test_y = []
    #     for x, l in tqdm.tqdm(dataloader):
    #         train_x.append(x.reshape(x.shape[0], -1))
    #     dataloader = DataLoader(test_dataset, batch_size=config['batch_size'], shuffle=True, num_workers=config['num_workers'])
    #     for x, l in tqdm.tqdm(dataloader):
    #         test_x.append(x.reshape(x.shape[0], -1))
    #         test_y.append(l)
    #
    #     train_x = torch.cat(train_x).cpu().numpy()
    #     test_x = torch.cat(test_x).cpu().numpy()
    #     test_y = torch.cat(test_y).cpu().numpy()
    #
    #     svm = OneClassSVM(kernel='rbf').fit(train_x)
    #     score = svm.score_samples(test_x)
    #     roc = roc_auc_score(test_y, score)
    #     roc_list.append(roc)
    #
    #     print(f'class: {_class}, roc: {roc}')
    #
    # print(roc_list)

    x = list(np.arange(1, 51))
    plt.figure(figsize=(20, 10), dpi=160)
    plt.plot(x, mnist_ent_max_gaussian_p_x, label='max entropy gaussian, p_x', color='tab:blue')
    plt.plot(x, mnist_ent_max_gaussian_cossim, label='max entropy gaussian, cossim', color='tab:orange')
    plt.plot(x, mnist_ent_max_uniform_p_x, label='max entropy uniform, p_x', color='tab:green')
    plt.plot(x, mnist_ent_max_uniform_cossim, label='max entropy uniform, cossim', color='tab:olive')
    plt.plot(x, mnist_random_p_x, label='random encoder, p_x', color='tab:brown')
    plt.plot(x, mnist_random_cossim, label='random encoder, cossim', color='tab:pink')
    plt.plot([x[0], x[-1]], [mnist_ocsvm, mnist_ocsvm], label='ocsvm', color='tab:red', linestyle='dashed')
    plt.xticks([1] + list(np.arange(2, 51, 2)))
    plt.xlabel('no of encoders')
    plt.ylabel('roc score')
    plt.legend()
    plt.grid()
    plt.show()

    x = list(np.arange(1, 11))
    plt.figure(figsize=(20, 10), dpi=160)
    plt.plot(x, cifar_ent_max_gaussian_p_x, label='max entropy gaussian, p_x', color='tab:blue')
    plt.plot(x, cifar_ent_max_gaussian_cossim, label='max entropy gaussian, cossim', color='tab:orange')
    plt.plot(x, cifar_ent_max_uniform_p_x, label='max entropy uniform, p_x', color='tab:green')
    plt.plot(x, cifar_ent_max_uniform_cossim, label='max entropy uniform, cossim', color='tab:olive')
    plt.plot(x, cifar_random_p_x, label='random encoder, p_x', color='tab:brown')
    plt.plot(x, cifar_random_cossim, label='random encoder, cossim', color='tab:pink')
    plt.plot([x[0], x[-1]], [cifar_ocsvm, cifar_ocsvm], label='ocsvm(rbf)', color='tab:red', linestyle='dashed')
    plt.xticks(x)
    plt.xlabel('no of encoders')
    plt.ylabel('roc score')
    plt.legend()
    plt.grid()
    plt.show()

